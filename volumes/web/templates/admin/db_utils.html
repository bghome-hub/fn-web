<!-- templates/admin/db_utils.html -->
{% extends "base.html" %}

{% block title %}Database Utilities{% endblock %}

{% block content %}
<h1>Database Utilities</h1>

<form method="POST" action="{{ url_for('db_utils') }}" class="db-utils-form">
    <label for="query_name">Select a Query:</label>
    <select id="query_name" name="query_name">
        <option value="get_all_articles">Get All Articles</option>
        <option value="get_all_authors">Get All Authors</option>
        <option value="get_all_citations">Get All Citations</option>
        <option value="get_all_images">Get All Images</option>
    </select>
    <button type="submit">Execute</button>
</form>

<h2>Backup Database</h2>
<form method="GET" action="{{ url_for('db_backup') }}">
    <button type="submit">Download Backup</button>
</form>

<h2>Restore Database</h2>
<form method="POST" action="{{ url_for('db_restore') }}" enctype="multipart/form-data">
    <label for="backup_file">Select Backup File:</label>
    <input type="file" id="backup_file" name="backup_file" required>
    <button type="submit">Restore</button>
</form>

{% if results %}
    <h2>Query Results</h2>
    <table>
        <thead>
            <tr>
                {% for column in results.columns %}
                <th>{{ column }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for row in results.data %}
            <tr>
                {% for cell in row %}
                <td>{{ cell }}</td>
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% endif %}
{% endblock %}